!function(a,b){"use strict";a.in=function(b){return new a.in.Listener(b)},a.extend(a.in,{Modules:{},Listener:a.Class.extend({x:0,y:0,dx:0,dy:0,module:null,element:null,init:function(c){"string"==typeof c&&(c={element:c}),a.Class.apply(this,[c]),null===this.element?this.element=b.document:"string"==typeof this.element&&(this.element=a.id(this.element)),this.module={};for(var d in a.in.Modules)this.module[d]=new a.in.Modules[d](this)},fire:function(a,b){return this.disabled||(b.j5g3in=this,b.name=a,this.on_fire&&this.on_fire(b)===!1)?void 0:this[a]?(b.preventDefault(),this[a](b)):void 0},set_pos:function(a,b){this.dx=a-this.x,this.dy=b-this.y,this.x=a,this.y=b},destroy:function(){this.disable()},enable:function(){this.disabled=!1;for(var a in this.module)this.module[a].enable()},disable:function(){this.disabled=!0;for(var a in this.module)this.module[a].disable()}}),Module:a.Class.extend({handler:null,el:null,enabled:!1,_enable:null,_disable:null,init:function(a){this.handler={},this.listener=a,this.el=a.element,this.enable()},_on:function(a,b){var c=b.bind(this);this.handler[a]=c,this.el.addEventListener(a,c)},_un:function(a){this.el.removeEventListener(a,this.handler[a])},enable:function(){return this.enabled||(this._enable(),this.enabled=!0),this},disable:function(){return this.enabled&&(this._disable(),this.enabled=!1),this}})})}(this.j5g3,this),function(a,b){"use strict";a.in.Modules.Mouse=a.in.Module.extend({x_threshold:1,y_threshold:1,bx:0,by:0,capture_move:!0,_calculate_bound:function(){var a,c=this.el;c.getBoundingClientRect?(a=c.getBoundingClientRect(),this.bx=b.scrollX+a.left,this.by=b.scrollY+a.top):(this.bx=c.clientLeft,this.by=c.clientTop)},_calculate_pos:function(a){var b=a.pageX-this.bx,c=a.pageY-this.by;this.listener.set_pos(b,c)},_click:function(a){var b={0:"buttonY",1:"buttonX",2:"buttonA"}[a.button];return this._calculate_pos(a),this.listener.fire(b,a),!1},_mousemove:function(a){this.capture_move&&(this._calculate_pos(a),(Math.abs(this.listener.dx)>this.x_threshold||Math.abs(this.listener.dy)>this.y_threshold)&&this.listener.fire("move",a))},_enable:function(){this._on("mousemove",this._mousemove),this._on("click",this._click),this._on("contextmenu",this._click),this.handler.scroll=this.handler.resize=this._calculate_bound.bind(this),b.addEventListener("resize",this.handler.resize),b.addEventListener("scroll",this.handler.scroll),this._calculate_bound()},_disable:function(){this._un("mousemove"),this._un("click"),this._un("contextmenu"),b.removeEventListener("scroll",this.handler.scroll),b.removeEventListener("resize",this.handler.resize)}})}(this.j5g3,this),function(a,b){"use strict";"ontouchstart"in b.document&&(a.in.Modules.Touch=a.in.Module.extend({x_threshold:50,y_threshold:50,flick_threshold:120,flick_delay:300,tap_delay:200,_calculate_pos:function(a){var b=a.changedTouches[0];this.listener.set_pos(b.pageX,b.pageY)},_touchmove:function(a){this._calculate_pos(a);var b,c=this.listener.x,d=this.listener.y,e=c-this._mx,f=d-this._my;e<-this.x_threshold?(this._mx=c,b="left"):e>this.x_threshold&&(this._mx=c,b="right"),f<-this.y_threshold?(this._my=d,b="up"+(b?"_"+b:"")):f>this.y_threshold&&(this._my=d,b="down"+(b?"_"+b:"")),b&&(this.listener.fire(b,a),a.direction=b,this.listener.fire("move",a))},_flick_action:function(a){var b,c=this.listener.x,d=this.listener.y,e=c-this._tx,f=d-this._ty;e<-this.flick_threshold?b="buttonY":e>this.flick_threshold&&(b="buttonA"),f<-this.flick_threshold?b="buttonX":f>this.flick_threshold&&(b="buttonB"),b?this.listener.fire(b,a):this.listener.fire("buttonY",a)},_touchstart:function(a){this._touchstart_t=Date.now(),this._tx=this._mx=a.touches[0].pageX,this._ty=this._my=a.touches[0].pageY},_touchend:function(a){var b=Date.now()-this._touchstart_t;this._calculate_pos(a),b<this.flick_delay&&this._flick_action(a)},_enable:function(){this._on("touchmove",this._touchmove),this._on("touchstart",this._touchstart),this._on("touchend",this._touchend)},_disable:function(){this._un("touchmove"),this._un("touchstart"),this._un("touchend")}}))}(this.j5g3,this),function(a,b){"use strict";var c=b.document,d={32:"buttonB",13:"buttonY",16:"buttonX",17:"buttonA",37:"left",38:"up",39:"right",40:"down",105:"up_right",103:"up_left",99:"down_right",97:"down_left"};a.in.Modules.Keyboard=a.in.Module.extend({keymap:null,interval:60,intervalId:null,keys:null,_keydown:function(a){this.keys[a.keyCode]=a,this.keymap[a.keyCode]&&a.preventDefault()},init:function(b){this.keys={},a.in.Module.apply(this,[b]),null===this.keymap&&a.extend(this.keymap={},d)},_keyup:function(a){this.keys[a.keyCode]=!1},_update:function(){var a,b,c;for(c in this.keymap)(b=this.keys[c])&&(a=this.keymap[c])&&(this.listener.fire(a,b),c>32&&(b.direction=a,this.listener.fire("move",b)))},_enable:function(){this.keys={},this.handler.keydown=this._keydown.bind(this),this.handler.keyup=this._keyup.bind(this),this.handler.update=this._update.bind(this),c.addEventListener("keydown",this.handler.keydown),c.addEventListener("keyup",this.handler.keyup),this.intervalId=b.setInterval(this.handler.update,this.interval)},_disable:function(){this.keys={},c.removeEventListener("keydown",this.handler.keydown),c.removeEventListener("keyup",this.handler.keyup),b.clearInterval(this.intervalId)}})}(this.j5g3,this),function(a,b){"use strict";b.navigator.webkitGetGamepads&&(a.in.Modules.Joystick=a.in.Module.extend({_enable:function(){},_disable:function(){}}))}(this.j5g3,this);